<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RedSpot | Redspot</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/redspot/assets/css/0.styles.9185cefc.css" as="style"><link rel="preload" href="/redspot/assets/js/app.da71e452.js" as="script"><link rel="preload" href="/redspot/assets/js/2.6489db0a.js" as="script"><link rel="preload" href="/redspot/assets/js/7.1bec3798.js" as="script"><link rel="prefetch" href="/redspot/assets/js/10.da2b854c.js"><link rel="prefetch" href="/redspot/assets/js/11.6de7a260.js"><link rel="prefetch" href="/redspot/assets/js/12.75c96f28.js"><link rel="prefetch" href="/redspot/assets/js/13.2e3fd5c0.js"><link rel="prefetch" href="/redspot/assets/js/14.5464a826.js"><link rel="prefetch" href="/redspot/assets/js/15.1ec13b27.js"><link rel="prefetch" href="/redspot/assets/js/16.b00b11b7.js"><link rel="prefetch" href="/redspot/assets/js/17.5cf08401.js"><link rel="prefetch" href="/redspot/assets/js/18.88f36f87.js"><link rel="prefetch" href="/redspot/assets/js/19.195eedbc.js"><link rel="prefetch" href="/redspot/assets/js/20.5405a902.js"><link rel="prefetch" href="/redspot/assets/js/21.6bc971a6.js"><link rel="prefetch" href="/redspot/assets/js/22.5dbb1acd.js"><link rel="prefetch" href="/redspot/assets/js/23.47d02d89.js"><link rel="prefetch" href="/redspot/assets/js/24.100b82ef.js"><link rel="prefetch" href="/redspot/assets/js/25.5f88e1cf.js"><link rel="prefetch" href="/redspot/assets/js/26.8e6b4b4f.js"><link rel="prefetch" href="/redspot/assets/js/27.36cf0ccb.js"><link rel="prefetch" href="/redspot/assets/js/28.6100e5b1.js"><link rel="prefetch" href="/redspot/assets/js/29.282c97e3.js"><link rel="prefetch" href="/redspot/assets/js/3.5cfc829d.js"><link rel="prefetch" href="/redspot/assets/js/30.c576c13e.js"><link rel="prefetch" href="/redspot/assets/js/31.4588434e.js"><link rel="prefetch" href="/redspot/assets/js/32.62724550.js"><link rel="prefetch" href="/redspot/assets/js/33.50a2d077.js"><link rel="prefetch" href="/redspot/assets/js/4.d6949b90.js"><link rel="prefetch" href="/redspot/assets/js/5.eefddad5.js"><link rel="prefetch" href="/redspot/assets/js/6.ffe6f60a.js"><link rel="prefetch" href="/redspot/assets/js/8.f647f11a.js"><link rel="prefetch" href="/redspot/assets/js/9.d70c6e6f.js">
    <link rel="stylesheet" href="/redspot/assets/css/0.styles.9185cefc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/redspot/" aria-current="page" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">Redspot</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>RedSpot</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/redspot/#overview" class="sidebar-link">Overview</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/redspot/#get-started-immediately" class="sidebar-link">Get Started Immediately</a></li><li class="sidebar-sub-header"><a href="/redspot/#install-from-template" class="sidebar-link">Install from template</a></li><li class="sidebar-sub-header"><a href="/redspot/#directory-tree" class="sidebar-link">Directory tree</a></li><li class="sidebar-sub-header"><a href="/redspot/#compile-contract" class="sidebar-link">Compile contract</a></li><li class="sidebar-sub-header"><a href="/redspot/#testing-contract" class="sidebar-link">Testing contract</a></li><li class="sidebar-sub-header"><a href="/redspot/#deploying-contract" class="sidebar-link">Deploying contract</a></li></ul></li><li><a href="/redspot/#configuration" class="sidebar-link">Configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/redspot/#available-config-options" class="sidebar-link">Available config options</a></li><li class="sidebar-sub-header"><a href="/redspot/#defaultnetwork" class="sidebar-link">defaultNetwork</a></li><li class="sidebar-sub-header"><a href="/redspot/#networks" class="sidebar-link">networks</a></li></ul></li><li><a href="/redspot/#runtime-environment" class="sidebar-link">Runtime Environment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/redspot/#using-the-rse" class="sidebar-link">Using the RSE</a></li><li class="sidebar-sub-header"><a href="/redspot/#accessing-the-rse-from-outside-a-task" class="sidebar-link">Accessing the RSE from outside a task</a></li><li class="sidebar-sub-header"><a href="/redspot/#extending-the-rse" class="sidebar-link">Extending the RSE</a></li><li class="sidebar-sub-header"><a href="/redspot/#rse-config" class="sidebar-link">rse.config</a></li><li class="sidebar-sub-header"><a href="/redspot/#rse-network" class="sidebar-link">rse.network</a></li><li class="sidebar-sub-header"><a href="/redspot/#rse-network-name" class="sidebar-link">rse.network.name</a></li><li class="sidebar-sub-header"><a href="/redspot/#rse-network-config" class="sidebar-link">rse.network.config</a></li></ul></li><li><a href="/redspot/#console" class="sidebar-link">Console</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="redspot"><a href="#redspot" class="header-anchor">#</a> RedSpot</h1> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <h3 id="get-started-immediately"><a href="#get-started-immediately" class="header-anchor">#</a> Get Started Immediately</h3> <div class="language- extra-class"><pre class="language-text"><code>$ npx redspot-new erc20
</code></pre></div><p>(npx is a package runner tool that comes with npm 5.2+ and higher, it ensures that you always install the latest version)</p> <p>Redspot will create a directory called flipper inside the current folder.</p> <p>Once the installation is done, you can open your project folder:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd erc20
</code></pre></div><p>Inside the newly created project, you can run some built-in commands:</p> <h4 id="npx-redspot-compile"><a href="#npx-redspot-compile" class="header-anchor">#</a> <code>npx redspot compile</code></h4> <p>Compile your contract into wasm</p> <h4 id="npx-redspot-test"><a href="#npx-redspot-test" class="header-anchor">#</a> <code>npx redspot test</code></h4> <p>Test your contract</p> <h4 id="npx-redspot-console"><a href="#npx-redspot-console" class="header-anchor">#</a> <code>npx redspot console</code></h4> <p>Open the interactive javascript console</p> <h4 id="npx-redspot-help"><a href="#npx-redspot-help" class="header-anchor">#</a> <code>npx redspot help</code></h4> <p>Get help information</p> <p><img src="https://user-images.githubusercontent.com/69485494/97970303-344d3e00-1e26-11eb-9030-843ea77bdd31.gif" alt=""></p> <h3 id="install-from-template"><a href="#install-from-template" class="header-anchor">#</a> Install from template</h3> <p>Redspot provides several contract templates: <code>flipper</code>, <code>delegator</code> , <code>dns</code>, <code>erc20</code>, <code>erc721</code> , <code>incrementer</code>, <code>multisig_plain</code>. You can intall them like this:</p> <div class="language- extra-class"><pre class="language-text"><code>$ npx redspot-new &lt;app-name&gt; --template &lt;template-name&gt;
</code></pre></div><p>For instance: <code>npx redspot-new flipper --template flipper</code></p> <p>The default contract template is <code>erc20</code>.</p> <h3 id="directory-tree"><a href="#directory-tree" class="header-anchor">#</a> Directory tree</h3> <div class="language- extra-class"><pre class="language-text"><code>app-name/
    |-.vscode/
        |-launch.json
    |-artifacts/
        |- &lt;would store compile contract artifacts, e.g. contracts abi(json) and wasm files&gt;
    |-contracts/
    		|-lib.rs
        |-Cargo.toml
    |-scripts
    		|-deploy.ts
    |-node_modules/
        |- ...
    |-tests/
        |-&lt;template-name&gt;.test.ts
    |-package.json
    |-redspot.config.js
    |-tsconfig.json
</code></pre></div><ul><li>The files generated by <code>npx redspot compile</code> are in <code>artifacts</code> folder by default. There are compile artifacts for contracts, like contract <strong>abi and wasm</strong> files.</li> <li><code>test</code> keeps test files. There are used for test contracts.</li></ul> <h3 id="compile-contract"><a href="#compile-contract" class="header-anchor">#</a> Compile contract</h3> <p>Use command <code>npx redspot compile</code> to compile the contracts and abi files used for generating contracts in project. This command can compile both main contract and sub-contract, but please notice that it can only produce the abi files of the main contract. (Will be resolved in the future https://github.com/paritytech/cargo-contract/issues/60)</p> <p>Prerequisites:</p> <ul><li>rust nightly: https://rust-lang.github.io/rustup/installation/index.html#installing-nightly</li> <li>rust-src: <code>rustup component add rust-src --toolchain nightly</code></li> <li>wasm-opt: https://github.com/WebAssembly/binaryen#tools</li> <li>cargo contract v0.7.1: <code>cargo install --git https://github.com/paritytech/cargo-contract cargo-contract --force</code></li></ul> <p>You can specify the contract name to compile, by default it compiles all contracts in the workspace.</p> <div class="language- extra-class"><pre class="language-text"><code>$ npx redspot compile --package &lt;ContractName&gt;
</code></pre></div><p>You can also specify the toolchain needed by compilation. The default one is nightly:</p> <div class="language- extra-class"><pre class="language-text"><code>$ npx redspot compile --toolchain stable
</code></pre></div><p>The files generated by compilation will be in <code>artifacts</code> directory by default.</p> <h3 id="testing-contract"><a href="#testing-contract" class="header-anchor">#</a> Testing contract</h3> <p>The sample project comes with these tests that use <code>@redspot/patract</code>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token constant">BN</span> <span class="token keyword">from</span> <span class="token string">&quot;bn.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> patract <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redspot&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> expect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;chai&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span>
  disconnect<span class="token punctuation">,</span>
  getContractFactory<span class="token punctuation">,</span>
  getRandomSigner<span class="token punctuation">,</span>
  getSigners<span class="token punctuation">,</span>
  getAbi<span class="token punctuation">,</span>
  api<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> patract<span class="token operator">!</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;ERC20&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> one <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BN</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BN</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>registry<span class="token punctuation">.</span>chainDecimals<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> signers <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getSigners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> Alice <span class="token operator">=</span> signers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> sender <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getRandomSigner</span><span class="token punctuation">(</span>Alice<span class="token punctuation">,</span> one<span class="token punctuation">.</span><span class="token function">muln</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> contractFactory <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">&quot;erc20&quot;</span><span class="token punctuation">,</span> sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> contract <span class="token operator">=</span> <span class="token keyword">await</span> contractFactory<span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span><span class="token string">&quot;new&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> abi <span class="token operator">=</span> <span class="token function">getAbi</span><span class="token punctuation">(</span><span class="token string">&quot;erc20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> receiver <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getRandomSigner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> sender<span class="token punctuation">,</span> contractFactory<span class="token punctuation">,</span> contract<span class="token punctuation">,</span> abi<span class="token punctuation">,</span> receiver<span class="token punctuation">,</span> Alice<span class="token punctuation">,</span> one <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;Assigns initial balance&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contract<span class="token punctuation">,</span> sender <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> contract<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span>sender<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token operator">?.</span>output<span class="token operator">?.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token string">&quot;1000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;Transfer adds amount to destination account&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contract<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> receiver <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> contract<span class="token punctuation">.</span>tx<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>receiver<span class="token punctuation">.</span>address<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> contract<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span>receiver<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>output<span class="token operator">?.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token string">&quot;7&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;Transfer emits event&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contract<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> receiver <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> contract<span class="token punctuation">.</span>tx<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>receiver<span class="token punctuation">.</span>address<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> event <span class="token operator">=</span> result<span class="token operator">?.</span>events<span class="token operator">?.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;Transfer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token keyword">from</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token operator">=</span> event<span class="token operator">?.</span>args <span class="token keyword">as</span> any<span class="token punctuation">;</span>

    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token keyword">from</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>sender<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>receiver<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;Can not transfer above the amount&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contract<span class="token punctuation">,</span> receiver <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> contract<span class="token punctuation">.</span>tx<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>receiver<span class="token punctuation">.</span>address<span class="token punctuation">,</span> <span class="token number">1007</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> event <span class="token operator">=</span> result<span class="token operator">?.</span>events<span class="token operator">?.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;Transfer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>undefined<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;Can not transfer from empty account&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contract<span class="token punctuation">,</span> Alice<span class="token punctuation">,</span> one<span class="token punctuation">,</span> sender <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> emptyAccount <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getRandomSigner</span><span class="token punctuation">(</span>Alice<span class="token punctuation">,</span> one<span class="token punctuation">.</span><span class="token function">muln</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> contract<span class="token punctuation">.</span>tx<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>sender<span class="token punctuation">.</span>address<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      signer<span class="token operator">:</span> emptyAccount<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> event <span class="token operator">=</span> result<span class="token operator">?.</span>events<span class="token operator">?.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;Transfer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>undefined<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>You can run your tests with <code>npx redspot test</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ npx redspot <span class="token builtin class-name">test</span>

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> Instantiate erc20 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Endowment:  <span class="token number">20003200000</span>
GasLimit:  <span class="token number">400000000000</span>
CodeHash:  0x372f716ec52a6662ff84b9c7670d087fe413ee717efd4c5ff40a9bb213452408
InputData:  0x50d183512be8030000000000000000000000000000
✔ Transaction fees: <span class="token number">2101427891</span>
✔ The gas consumption of erc20 instantiate: <span class="token number">26766000000</span>
✔ erc20 address: 5EZN12RXKxUWdESK9kSBfFt6516FVnZW45TuMF5oXkj4egEP
ℹ Generate random signer: 5G6iEXWUpZGdoogetkau1URB1t3N6i9ZQL84CisuEFtGn7c4
ℹ Mnemonic: dash <span class="token function">host</span> stuff tortoise alcohol warm awful artefact <span class="token function">expand</span> spoon gloom hover
ℹ Generate random signer: 5G14hV8a3NLKUxt5tczGoPEfGY3ADm7Nt6PBFWuhSyNqYpYj
ℹ Mnemonic: wrist toast layer erosion involve hedgehog rhythm illegal parent copy miracle tent
ℹ Transfer <span class="token number">100000000000</span> from 5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY to 5G14hV8a3NLKUxt5tczGoPEfGY3ADm7Nt6PBFWuhSyNqYpYj

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> Exec transfer <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
dest:  0x6e53be1dfa20af0403088fa1c94748bf1864e60016a910a9005b0e520ac8a145
value:  <span class="token number">0</span>
gasLimit:  <span class="token number">400000000000</span>
inputData:  0xd0fae3a09da4d7bfa17ea2d60835ca3c5fac7ea6ca6e18f32f842562d69adf7b7e5742f51307000000000000000000000000000000
✔ Execute successfully
✔ https://polkadot.js.org/apps/<span class="token comment">#/explorer/query/0x62b09ff094c9259df70832e35845a609b5b5b7a8217ba8c8263eb7ab24e39182</span>
  ✓ Can not transfer from empty account <span class="token punctuation">(</span>4007ms<span class="token punctuation">)</span>


  <span class="token number">5</span> passing <span class="token punctuation">(</span>16s<span class="token punctuation">)</span>
</code></pre></div><h3 id="deploying-contract"><a href="#deploying-contract" class="header-anchor">#</a> Deploying contract</h3> <p>To deploy the contract we will use a Redspot script. Inside scripts/ you will find deploy.ts with the following code:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> patract<span class="token punctuation">,</span> network <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redspot&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> getContractFactory<span class="token punctuation">,</span> disconnect <span class="token punctuation">}</span> <span class="token operator">=</span> patract<span class="token operator">!</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> uri <span class="token operator">=</span>
  <span class="token string">&quot;bottom drive obey lake curtain smoke basket hold race lonely fit walk//Alice&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> connect<span class="token punctuation">,</span> api <span class="token punctuation">}</span> <span class="token operator">=</span> patract<span class="token operator">!</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> signer <span class="token operator">=</span> network<span class="token punctuation">.</span>provider<span class="token punctuation">.</span><span class="token function">createSigner</span><span class="token punctuation">(</span>
    network<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>keyring<span class="token punctuation">.</span><span class="token function">createFromUri</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> contractFactory <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getContractFactory</span><span class="token punctuation">(</span><span class="token string">&quot;erc20&quot;</span><span class="token punctuation">,</span> signer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> balance <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span>query<span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">account</span><span class="token punctuation">(</span>signer<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Balance: &quot;</span><span class="token punctuation">,</span> balance<span class="token punctuation">.</span><span class="token function">toHuman</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> contract <span class="token operator">=</span> <span class="token keyword">await</span> contractFactory<span class="token punctuation">.</span><span class="token function">deployed</span><span class="token punctuation">(</span><span class="token string">&quot;new&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1000000&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    gasLimit<span class="token operator">:</span> <span class="token string">&quot;200000000000&quot;</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token string">&quot;10000000000000000&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token string">&quot;Deploy successfully. The contract address: &quot;</span><span class="token punctuation">,</span>
    contract<span class="token punctuation">.</span>address<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Run it with <code>npx redspot run scripts/deploy.ts</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> Instantiate erc20 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Endowment:  <span class="token number">10000000000000000</span>
GasLimit:  <span class="token number">200000000000</span>
CodeHash:  0x372f716ec52a6662ff84b9c7670d087fe413ee717efd4c5ff40a9bb213452408
InputData:  0x50d183512b40420f00000000000000000000000000
✔ Transaction fees: <span class="token number">2319536570</span>
✔ The gas consumption of erc20 instantiate: <span class="token number">26766000000</span>
✔ erc20 address: 5FX3AbZFE1jedXSMT3C8uXbDLDjp6AyAer56TzwewtWrahHQ

Deploy successfully. The contract address:  5FX3AbZFE1jedXSMT3C8uXbDLDjp6AyAer56TzwewtWrahHQ

ERROR  Disconnected from ws://192.168.1.165:9944: <span class="token number">1000</span>:: Normal connection closure
</code></pre></div><h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>When Redspot is run, it searches for the closest redspot.config.js file starting from the Current Working Directory. This file normally lives in the root of your project. An empty redspot.config.js is enough for Redspot to work.</p> <p>The entirety of your Redspot setup (i.e. your config, plugins and custom tasks) is contained in this file</p> <h3 id="available-config-options"><a href="#available-config-options" class="header-anchor">#</a> Available config options</h3> <p>To set up your config, you have to export an object from redspot.config.js.</p> <p>This object can have the following entries: defaultNetwork, networks, and paths. For example:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  defaultNetwork<span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
  rust<span class="token operator">:</span> <span class="token punctuation">{</span>
    toolchain<span class="token operator">:</span> <span class="token string">&quot;nightly&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  networks<span class="token operator">:</span> <span class="token punctuation">{</span>
    development<span class="token operator">:</span> <span class="token punctuation">{</span>
      endpoint<span class="token operator">:</span> <span class="token string">&quot;ws://127.0.0.1:9944&quot;</span><span class="token punctuation">,</span>
      types<span class="token operator">:</span> <span class="token punctuation">{</span>
        Address<span class="token operator">:</span> <span class="token string">&quot;AccountId&quot;</span><span class="token punctuation">,</span>
        LookupSource<span class="token operator">:</span> <span class="token string">&quot;AccountId&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      gasLimit<span class="token operator">:</span> <span class="token string">&quot;400000000000&quot;</span><span class="token punctuation">,</span>
      explorerUrl<span class="token operator">:</span> <span class="token string">&quot;https://polkadot.js.org/apps/#/explorer/query/&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    substrate<span class="token operator">:</span> <span class="token punctuation">{</span>
      endpoint<span class="token operator">:</span> <span class="token string">&quot;ws://127.0.0.1:9944&quot;</span><span class="token punctuation">,</span>
      gasLimit<span class="token operator">:</span> <span class="token string">&quot;400000000000&quot;</span><span class="token punctuation">,</span>
      accounts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;//Alice&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      types<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mocha<span class="token operator">:</span> <span class="token punctuation">{</span>
    timeout<span class="token operator">:</span> <span class="token number">60000</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>You can get your configuration details via <a href="#config"><code>env.config</code></a>.</p> <h3 id="defaultnetwork"><a href="#defaultnetwork" class="header-anchor">#</a> defaultNetwork</h3> <p>You can customize which network is used by default when running Redspot by setting the config's <code>defaultNetwork</code> field. If you omit this config, its default value is &quot;localhost&quot;.</p> <h3 id="networks"><a href="#networks" class="header-anchor">#</a> networks</h3> <p>The <code>networks</code> config field is an optional object where network names map to their configuration.</p> <p>The default localhost network configuration is:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  localhost<span class="token operator">:</span> <span class="token punctuation">{</span>
    gasLimit<span class="token operator">:</span> <span class="token string">&quot;400000000000&quot;</span><span class="token punctuation">,</span>
    accounts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;//Alice&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;//Bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;//Charlie&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;//Dave&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;//Eve&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;//Ferdie&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    endpoint<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;ws://127.0.0.1:9944&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    types<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    httpHeaders<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    explorerUrl<span class="token operator">:</span> <span class="token string">&quot;https://polkadot.js.org/apps/#/explorer/query/&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="network-gaslimit"><a href="#network-gaslimit" class="header-anchor">#</a> [network].gasLimit</h4> <p>This value is used by default when instantiating a contract and invoking a contract transaction.</p> <p>If this value is too small, you will get a <code>contracts.OutOfGas</code> error. The maximum value of gaslimit is <code>System.MaximumBlockWeight</code>(In Sustrate, it is <code>2000000000000</code>).</p> <h4 id="network-accounts"><a href="#network-accounts" class="header-anchor">#</a> [network].accounts</h4> <p>The <code>accounts</code> should be an array of <a href="https://polkadot.js.org/docs/keyring/start/suri/" target="_blank" rel="noopener noreferrer">suri<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://polkadot.js.org/docs/keyring/start/create#adding-a-pair" target="_blank" rel="noopener noreferrer">KeyringPair<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>At run time, you can obtain accounts in the form <code>keyringPair</code> by <code>await env.network.provider.getKeyringpairs()</code>. For details, see <a href="#network.provider">network.provider</a></p> <h4 id="network-endpoint"><a href="#network-endpoint" class="header-anchor">#</a> [network].endpoint</h4> <p>The endpoint can specify the address of the node to which you want to connect, either <code>string</code> or <code>string[]</code></p> <p>At this time, only WebSockets versions of RPC are supported.</p> <h4 id="network-types"><a href="#network-types" class="header-anchor">#</a> [network].types</h4> <p>the <code>types</code> are the concepts defined in polkadotjs. If you have any questions about this, you can see it here <a href="https://polkadot.js.org/docs/api/start/types.extend" target="_blank" rel="noopener noreferrer">types.extend<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. You can also set [network].typesbundle, [network].typesSpec and so on. In general, if you encounter an error that is similar to 'No such variant in enum MultiSignature', ,maybe you should think about adding or removing types <code>{ Address: &quot;AccountId&quot;, LookupSource: &quot;AccountId&quot;}</code>, see <a href="https://polkadot.js.org/docs/api/start/types.extend#impact-on-extrinsics" target="_blank" rel="noopener noreferrer">impact-on-extrinsics<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h4 id="network-httpheaders"><a href="#network-httpheaders" class="header-anchor">#</a> [network].httpHeaders</h4> <p>This setting will be added to the webSocket connection headers</p> <h4 id="network-explorerurl"><a href="#network-explorerurl" class="header-anchor">#</a> [network].explorerUrl</h4> <p>This setting is currently used with @redspot/patract. After the transaction is inblock, the console will print the link: <code>explorerUrl + bloackhash</code>. The default value is https://polkadot.js.org/apps/#/explorer/query/.</p> <h2 id="runtime-environment"><a href="#runtime-environment" class="header-anchor">#</a> Runtime Environment</h2> <p>The RedSpot runtime environment(RSE) contains all the functionality that Redspot exposes when running a task, test or script.</p> <p>When you require Redspot (const redspot = require(&quot;redspot&quot;)) you're getting an instance of the RSE.</p> <p>During initialization, the Redspot configuration file essentially constructs a list of things to be added to the RSE. This includes tasks, configs and plugins. Then when tasks, tests or scripts run, the RSE is always present and available to access anything that is contained in it.</p> <p>The RSE has a role of centralizing coordination across all Redspot components. This architecture allows for plugins to inject functionality that becomes available everywhere the RedSpot runtime environment is accessible.</p> <h3 id="using-the-rse"><a href="#using-the-rse" class="header-anchor">#</a> Using the RSE</h3> <p>By default, the RSE gives you programmatic access to the task runner and the config system, and exports a Provider that is compatible with Polkadot WsProvider</p> <p>Plugins can extend the RSE. For example, @redspot/patract adds a api instance to it, making it available to tasks, tests and scripts.</p> <p>When writing tests or scripts, you can use require(&quot;redspot&quot;) to import the RSE. You can read more about this in Accessing the RSE from outside a task.</p> <h3 id="accessing-the-rse-from-outside-a-task"><a href="#accessing-the-rse-from-outside-a-task" class="header-anchor">#</a> Accessing the RSE from outside a task</h3> <p>The RSE can be used from any JavaScript or TypeScript file. To do so, you only have to import it with require(&quot;redspot&quot;). You can do this to keep more control over your development workflow, create your own tools, or to use Redspot with other dev tools from the node.js ecosystem.</p> <p>Running test directly with Mocha instead of npx redspot test can be done by explicitly importing the RSE in them like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> rse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;redspot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;assert&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;Redspot Runtime Environment&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;should have a config field&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    assert<span class="token punctuation">.</span><span class="token function">notEqual</span><span class="token punctuation">(</span>rse<span class="token punctuation">.</span>config<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This way, tests written for Redspot are just normal Mocha tests. This enables you to run them any way you like without the need of any Redspot-specific plugin.</p> <h3 id="extending-the-rse"><a href="#extending-the-rse" class="header-anchor">#</a> Extending the RSE</h3> <p>Redspot lets you hook into the RSE construction, and extend it with new functionality. This way, you only have to initialize everything once, and your new features or libraries will be available everywhere the RSE is used.</p> <p>You can do this by adding a RSE extender into a queue. This extender is just a synchronous function that receives the RSE, and adds fields to it with your new functionality. These new fields will also get injected into the global scope during runtime.</p> <p>For example, adding an instance of Polkadot.js to the RSE can be done in this way:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> extendEnvironment <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;redspot/config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">extendEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">rse</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> ApiPromise <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@polkadot/api&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  rse<span class="token punctuation">.</span>api <span class="token operator">=</span> api<span class="token punctuation">;</span>

  rse<span class="token punctuation">.</span>api <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApiPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="rse-config"><a href="#rse-config" class="header-anchor">#</a> rse.config</h3> <p>Config contains configuration options for the user config file and default options for RedSpot. For example, if you want to get the current default network:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> rse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;redspot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rse<span class="token punctuation">.</span>config<span class="token punctuation">.</span>defaultNetwork<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="rse-network"><a href="#rse-network" class="header-anchor">#</a> rse.network</h3> <p>Network Contains information about the network you are currently running.</p> <h3 id="rse-network-name"><a href="#rse-network-name" class="header-anchor">#</a> rse.network.name</h3> <p>The name of the network being used.</p> <h3 id="rse-network-config"><a href="#rse-network-config" class="header-anchor">#</a> rse.network.config</h3> <p>A configuration item for the network being used. It is equivalent to <code>rse.config.networks.[rse.network.name]</code></p> <h4 id="rse-network-provider"><a href="#rse-network-provider" class="header-anchor">#</a> rse.network.provider</h4> <p>The Provider for polkadot network. It derived from Polkadot.js WsProvider.</p> <h4 id="rse-network-provider-registry"><a href="#rse-network-provider-registry" class="header-anchor">#</a> rse.network.provider.registry</h4> <p>TypeRegistry of Polkadot.js, which has registered the configured types</p> <h5 id="rse-network-provider-getkeyringpairs-⇒-promise-keyringpair"><a href="#rse-network-provider-getkeyringpairs-⇒-promise-keyringpair" class="header-anchor">#</a> rse.network.provider.getKeyringPairs() ⇒ Promise&lt;KeyringPair[]&gt;</h5> <p>Gets the accounts that you configure for the network. These accounts will be resolved to the <a href="https://polkadot.js.org/docs/keyring/start/create#adding-a-pair" target="_blank" rel="noopener noreferrer">KeyringPair<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="console"><a href="#console" class="header-anchor">#</a> Console</h2> <p>Redspot comes built-in with an interactive JavaScript console. You can use it by running <code>npx redspot console</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>Welcome to Node.js v14.15.1.
Type &quot;.help&quot; for more information.
&gt; 
</code></pre></div><p>The compile task will be called before opening the console prompt, but you can skip this with the --no-compile parameter.</p> <p>The execution environment for the console is the same as for tasks. This means the configuration has been processed, and the <a href="#RuntimeEnvironment">Redspot Runtime Environment</a> initialized and injected into the global scope. For example, that you'll have access in the global scope to the config object:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; config
{ 
  defaultNetwork: 'development',
  rust: { toolchain: 'nightly-2020-10-07' },
  
  ...
}
&gt;
</code></pre></div><p>And the initialized <code>patract</code> object if you're using the @redspot/patract plugin:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; patract
{ provider:
       
  ...

  },
  ...
&gt;
</code></pre></div><p>Anything that has been injected into the Redspot Runtime Environment will be available in the global scope. you can also require the RSE explicitly and get autocomplete:</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; config.i
config.isPrototypeOf

config.ink
</code></pre></div><p>Redspot's console supports await top-level await (i.e. <code>console.log(await patract.ready()</code>)</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/redspot/assets/js/app.da71e452.js" defer></script><script src="/redspot/assets/js/2.6489db0a.js" defer></script><script src="/redspot/assets/js/7.1bec3798.js" defer></script>
  </body>
</html>

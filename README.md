---
sidebar: auto
---

# RedSpot

## Get Started Immediately

```
$ npx redspot-new erc20
```

(npx is a package runner tool that comes with npm 5.2+ and higher, it ensures that you always install the latest version)

Redspot will create a directory called flipper inside the current folder.

Once the installation is done, you can open your project folder:

```
$ cd erc20
```

Inside the newly created project, you can run some built-in commands:

#### `npx redspot compile`

Compile your contract into wasm

#### `npx redspot test`

Test your contract

#### `npx redspot console`

Open the interactive javascript console

#### `npx redspot help`

Get help information

![](https://user-images.githubusercontent.com/69485494/97970303-344d3e00-1e26-11eb-9030-843ea77bdd31.gif)



## Install from template

Redspot provides several contract templates: `flipper`, `delegator` , `dns`, `erc20`, `erc721` , `incrementer`, `multisig_plain`. You can intall them like this:

```
$ npx redspot-new <app-name> --template <template-name>
```

For instance: `npx redspot-new flipper --template flipper`

The default contract template is `erc20`.

## Directory tree

```
app-name/
    |-.vscode/
        |-launch.json
    |-artifacts/
        |- <would store compile contract artifacts, e.g. contracts abi(json) and wasm files>
    |-contracts/
    		|-lib.rs
        |-Cargo.toml
    |-scripts
    		|-deploy.ts
    |-node_modules/
        |- ...
    |-tests/
        |-<template-name>.test.ts
    |-package.json
    |-redspot.config.js
    |-tsconfig.json
```

- The files generated by `npx redspot compile` are in `artifacts` folder by default. There are compile artifacts for contracts, like contract **abi and wasm** files.
- `test` keeps test files. There are used for test contracts. 

## Compile contract

Use command `npx redspot compile` to compile the contracts and abi files used for generating contracts in project. This command can compile both main contract and sub-contract, but please notice that it can only produce the abi files of the main contract. (Will be resolved in the future https://github.com/paritytech/cargo-contract/issues/60)

Prerequisites:

- rust-src: `rustup component add rust-src`
- wasm-opt: https://github.com/WebAssembly/binaryen#tools
- cargo contract v0.7.0: `cargo install --git https://github.com/paritytech/cargo-contract cargo-contract --force`
- rust nightly: https://rust-lang.github.io/rustup/installation/index.html#installing-nightly

You can specify the contract name to compile, by default it compiles all contracts in the workspace.

```
$ npx redspot compile --package <ContractName>
```

You can also specify the toolchain needed by compilation. The default one is nightly:

```
$ npx redspot compile --toolchain stable
```

The files generated by compilation will be in `artifacts` directory by default.



## Testing contract

The sample project comes with these tests that use `@redspot/patract`. 

```javascript
import BN from "bn.js";
import { patract } from "redspot";
import { expect } from "chai";

const {
  disconnect,
  getContractFactory,
  getRandomSigner,
  getSigners,
  getAbi,
  api,
} = patract!;

describe("ERC20", () => {
  after(() => {
    return disconnect();
  });

  async function setup() {
    const one = new BN(10).pow(new BN(api.registry.chainDecimals));
    const signers = await getSigners();
    const Alice = signers[0];
    const sender = await getRandomSigner(Alice, one.muln(10));
    const contractFactory = await getContractFactory("erc20", sender);
    const contract = await contractFactory.deploy("new", "1000");
    const abi = getAbi("erc20");
    const receiver = await getRandomSigner();

    return { sender, contractFactory, contract, abi, receiver, Alice, one };
  }

  it("Assigns initial balance", async () => {
    const { contract, sender } = await setup();
    const result = await contract.query.balanceOf(sender.pair.address);
    expect(result?.output?.toString()).to.equal("1000");
  });

  it("Transfer adds amount to destination account", async () => {
    const { contract, sender, receiver } = await setup();

    await contract.tx.transfer(receiver.pair.address, 7);

    const result = await contract.query.balanceOf(receiver.pair.address);

    expect(result.output?.toString()).to.equal("7");
  });

  it("Transfer emits event", async () => {
    const { contract, sender, receiver } = await setup();

    const result = await contract.tx.transfer(receiver.pair.address, 7);

    const event = result?.events?.find((e) => e.name === "Transfer");

    const [from, to, value] = event?.args as any;

    expect(from.unwrap().toString()).to.equal(sender.pair.address);
    expect(to.unwrap().toString()).to.equal(receiver.pair.address);
    expect(value.toNumber()).to.equal(7);
  });

  it("Can not transfer above the amount", async () => {
    const { contract, receiver } = await setup();

    const result = await contract.tx.transfer(receiver.pair.address, 1007);

    const event = result?.events?.find((e) => e.name === "Transfer");

    expect(event).to.be.undefined;
  });

  it("Can not transfer from empty account", async () => {
    const { contract, Alice, one, sender } = await setup();

    const emptyAccount = await getRandomSigner(Alice, one.muln(10));

    const result = await contract.tx.transfer(sender.pair.address, 7, {
      signer: emptyAccount,
    });

    const event = result?.events?.find((e) => e.name === "Transfer");

    expect(event).to.be.undefined;
  });
});

```

You can run your tests with `npx redspot test`



